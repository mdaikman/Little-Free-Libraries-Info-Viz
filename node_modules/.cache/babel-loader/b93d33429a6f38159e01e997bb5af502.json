{"ast":null,"code":"import _slicedToArray from\"C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{MapContainer,TileLayer,GeoJSON,LayersControl}from\"react-leaflet\";import Legend from\"./Legend.js\";import{features}from\"../data/CSDs_LFLs.json\";import lflFeatures from\"../data/LFLs_assigned.json\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Map=/*#__PURE__*/function(_React$Component){_inherits(Map,_React$Component);var _super=_createSuper(Map);function Map(){var _this;_classCallCheck(this,Map);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.defaultStyle=function(feature){return{fillColor:\"#54c5d5\",weight:1,opacity:1,color:\"black\",fillOpacity:0.6};};_this.highlightStyle=function(){return{fillColor:\"#78716e\",weight:1,opacity:1,color:\"black\",fillOpacity:0.6};};_this.onEachCSD=function(csd,layer){var name=csd.properties[\"Census subdivision name\"];layer.bindTooltip(name).openTooltip();layer.on({click:_this.clicked.bind(_assertThisInitialized(_this))});};_this.onEachLibrary=function(library,layer){layer.setOpacity(0);layer.options.interactive=false;};_this.clicked=function(ev){var oldSelected=_this.props.state.selectedFeature;var newSelected=ev.target;// If there is no previously selected feature, style the current selection\nif(oldSelected===null){newSelected.setStyle(_this.highlightStyle(newSelected.feature));}// Un-highlight the re-selected feature\nelse if(oldSelected.feature.properties[\"Census subdivision name\"]===newSelected.feature.properties[\"Census subdivision name\"]){newSelected.setStyle(_this.defaultStyle(newSelected.feature));newSelected=null;}// Un-highlight the old selected feature and highlight the new one\nelse if(oldSelected.feature.properties[\"Census subdivision name\"]!==newSelected.feature.properties[\"Census subdivision name\"]){oldSelected.setStyle(_this.defaultStyle(oldSelected.feature));newSelected.setStyle(_this.highlightStyle(newSelected.feature));}// Update the selected feature in index.js\n_this.props.onMapFeatureClick(newSelected);// Show Libraries over the selected feature\n_this.showLibraries();// Update legend info panel\n_this.props.state.map._controlCorners.bottomleft.innerHTML=_this.setInfoPanelHTML(newSelected);};return _this;}_createClass(Map,[{key:\"showLibraries\",value:function showLibraries(){var _this2=this;if(this.props.state.selectedFeature===null){// Set opacity to 0 for all existing libraries\nthis.props.state.map.eachLayer(function(layer){if(!layer.feature||layer.feature.properties.Name===undefined)return;layer.setOpacity(0);},this);return;}this.props.state.map.eachLayer(function(layer){if(!layer.feature||layer.feature.properties.Name===undefined)return;if(layer.feature.properties[\"Census subdivision name\"]===_this2.props.state.selectedFeature.feature.properties[\"Census subdivision name\"]){layer.setOpacity(1);}else{layer.setOpacity(0);}},this);}},{key:\"setInfoPanelHTML\",value:function setInfoPanelHTML(target){if(target==null){return\"<div class='info leaflet-control'>\"+\"<h2><span>Waiting for Map Feature Selection...</span>&nbsp;</h2>\"+\"</div>\";}var info=\"<div class='info leaflet-control'>\";var index=this.props.state.infoPanel.findIndex(function(x){return x.id===target.feature.properties[\"Census subdivision name\"];});var name=this.props.state.infoPanel[index].id;var data=this.props.state.infoPanel[index].data[0];info+=\"<h2><span>\".concat(name,\"</span></h2>\");Object.entries(data).forEach(function(entry){var _entry=_slicedToArray(entry,2),key=_entry[0],value=_entry[1];if(key==='x'||key==='y'||value===name)return;info+=\"<h3><span>\".concat(key,\": \").concat(value,\"</span></h4>\");});info+=\"</div>\";return info;}},{key:\"setMap\",value:function setMap(map){this.props.onMapCreate(map);}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(MapContainer,{center:[48.4284,-123.7656],zoom:9,scrollWheelZoom:true,whenCreated:this.setMap.bind(this),children:[/*#__PURE__*/_jsxs(LayersControl,{position:\"topright\",children:[/*#__PURE__*/_jsx(LayersControl.BaseLayer,{checked:true,name:\"OpenStreetMap\",children:/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"})}),/*#__PURE__*/_jsx(LayersControl.Overlay,{checked:true,name:\"Little Free Libraries\",children:/*#__PURE__*/_jsx(GeoJSON,{data:lflFeatures,onEachFeature:this.onEachLibrary})}),/*#__PURE__*/_jsx(LayersControl.Overlay,{checked:true,name:\"Census Subdivisions\",children:/*#__PURE__*/_jsx(GeoJSON,{style:this.defaultStyle,data:features,onEachFeature:this.onEachCSD})})]}),/*#__PURE__*/_jsx(Legend,{})]});}}]);return Map;}(React.Component);export{Map as default};","map":{"version":3,"sources":["C:/Users/mda/Desktop/goGITit/invisible/Info-Viz/src/components/Map.js"],"names":["React","MapContainer","TileLayer","GeoJSON","LayersControl","Legend","features","lflFeatures","Map","defaultStyle","feature","fillColor","weight","opacity","color","fillOpacity","highlightStyle","onEachCSD","csd","layer","name","properties","bindTooltip","openTooltip","on","click","clicked","bind","onEachLibrary","library","setOpacity","options","interactive","ev","oldSelected","props","state","selectedFeature","newSelected","target","setStyle","onMapFeatureClick","showLibraries","map","_controlCorners","bottomleft","innerHTML","setInfoPanelHTML","eachLayer","Name","undefined","info","index","infoPanel","findIndex","x","id","data","Object","entries","forEach","entry","key","value","onMapCreate","setMap","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { MapContainer, TileLayer, GeoJSON, LayersControl } from \"react-leaflet\";\r\nimport Legend from \"./Legend.js\";\r\n\r\nimport { features } from \"../data/CSDs_LFLs.json\";\r\nimport lflFeatures  from \"../data/LFLs_assigned.json\";\r\n\r\nexport default class Map extends React.Component {\r\n  defaultStyle = (feature) => {\r\n    return {\r\n      fillColor: \"#54c5d5\",\r\n      weight: 1,\r\n      opacity: 1,\r\n      color: \"black\",\r\n      fillOpacity: 0.6,\r\n    };\r\n  };\r\n\r\n  highlightStyle = () => {\r\n    return {\r\n      fillColor: \"#78716e\",\r\n      weight: 1,\r\n      opacity: 1,\r\n      color: \"black\",\r\n      fillOpacity: 0.6,\r\n    };\r\n  };\r\n\r\n  onEachCSD = (csd, layer) => {\r\n    let name = csd.properties[\"Census subdivision name\"];\r\n\r\n    layer.bindTooltip(name).openTooltip();\r\n\r\n    layer.on({ click: this.clicked.bind(this) });\r\n  };\r\n\r\n  onEachLibrary = (library, layer) => {\r\n    layer.setOpacity(0);\r\n    layer.options.interactive = false\r\n  };\r\n\r\n  clicked = (ev) => {\r\n    let oldSelected = this.props.state.selectedFeature;\r\n    let newSelected = ev.target;\r\n\r\n    // If there is no previously selected feature, style the current selection\r\n    if(oldSelected === null) {\r\n      newSelected.setStyle(this.highlightStyle(newSelected.feature));\r\n      \r\n    } \r\n    // Un-highlight the re-selected feature\r\n    else if (oldSelected.feature.properties[\"Census subdivision name\"] === newSelected.feature.properties[\"Census subdivision name\"]) {\r\n      newSelected.setStyle(this.defaultStyle(newSelected.feature));\r\n      newSelected = null;\r\n    }\r\n    // Un-highlight the old selected feature and highlight the new one\r\n    else if (oldSelected.feature.properties[\"Census subdivision name\"] !== newSelected.feature.properties[\"Census subdivision name\"]) {\r\n      oldSelected.setStyle(this.defaultStyle(oldSelected.feature));\r\n      newSelected.setStyle(this.highlightStyle(newSelected.feature));\r\n    }\r\n\r\n    // Update the selected feature in index.js\r\n    this.props.onMapFeatureClick(newSelected);\r\n\r\n    // Show Libraries over the selected feature\r\n    this.showLibraries();\r\n\r\n    // Update legend info panel\r\n    this.props.state.map._controlCorners.bottomleft.innerHTML = this.setInfoPanelHTML(newSelected);\r\n  } \r\n\r\n  showLibraries() {\r\n    if(this.props.state.selectedFeature === null) {\r\n      // Set opacity to 0 for all existing libraries\r\n      this.props.state.map.eachLayer((layer) => {\r\n         if (!layer.feature || layer.feature.properties.Name === undefined) return;\r\n           layer.setOpacity(0);\r\n      }, this);\r\n      return;\r\n    }\r\n\r\n    this.props.state.map.eachLayer((layer) => {\r\n         if (!layer.feature || layer.feature.properties.Name === undefined) return;\r\n\r\n         if (layer.feature.properties[\"Census subdivision name\"] === this.props.state.selectedFeature.feature.properties[\"Census subdivision name\"]) {\r\n           layer.setOpacity(1);\r\n         } else {\r\n           layer.setOpacity(0);\r\n         }\r\n    }, this);\r\n  }\r\n\r\n  setInfoPanelHTML(target) {\r\n    if(target == null) {\r\n      return (\r\n        `<div class='info leaflet-control'>` +\r\n        `<h2><span>Waiting for Map Feature Selection...</span>&nbsp;</h2>` +\r\n        `</div>`\r\n      )\r\n    }\r\n\r\n    let info = `<div class='info leaflet-control'>`;\r\n    \r\n    let index = this.props.state.infoPanel.findIndex(x => x.id === target.feature.properties[\"Census subdivision name\"]);\r\n\r\n    let name = this.props.state.infoPanel[index].id\r\n\r\n    let data = this.props.state.infoPanel[index].data[0];\r\n\r\n    info += `<h2><span>${name}</span></h2>`;\r\n\r\n    Object.entries(data).forEach(entry => {\r\n      const [key, value] = entry;\r\n      if(key === 'x' || key === 'y' || value === name) return;\r\n\r\n      info += `<h3><span>${key}: ${value}</span></h4>`\r\n    });\r\n\r\n    info += `</div>`;\r\n\r\n    return info;\r\n  }\r\n\r\n  setMap(map) {\r\n    this.props.onMapCreate(map);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <MapContainer\r\n        center={[48.4284, -123.7656]}\r\n        zoom={9}\r\n        scrollWheelZoom={true}\r\n        whenCreated={this.setMap.bind(this)}\r\n      >\r\n        <LayersControl position=\"topright\">\r\n          <LayersControl.BaseLayer checked name=\"OpenStreetMap\">\r\n            <TileLayer\r\n              attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n              url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n            />\r\n          </LayersControl.BaseLayer>\r\n\r\n          <LayersControl.Overlay checked name=\"Little Free Libraries\">\r\n            <GeoJSON\r\n              data={lflFeatures}\r\n              onEachFeature={this.onEachLibrary}\r\n            />\r\n          </LayersControl.Overlay>\r\n\r\n          <LayersControl.Overlay checked name=\"Census Subdivisions\">\r\n            <GeoJSON\r\n              style={this.defaultStyle}\r\n              data={features}\r\n              onEachFeature={this.onEachCSD}\r\n            />\r\n          </LayersControl.Overlay>\r\n\r\n        </LayersControl>\r\n        <Legend />\r\n      </MapContainer>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}